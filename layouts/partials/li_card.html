{{ $item := . }}


{{/* Dynamic view adjusts to content type. */}}
{{ $show_buttons := false }}
{{ if eq $item.Type "courses" }}
  {{ $show_buttons = true }}
{{ else if eq $item.Type "publication" }}
  {{ $show_buttons = true }}
{{ end }}

{{/* Get summary. */}}
{{ $summary := "" }}
{{ if $item.Params.summary }}
  {{ $summary = $item.Params.summary | markdownify | emojify }}
{{ else if .Params.abstract }}
  {{ $summary = .Params.abstract | markdownify | emojify }}
{{ else if $item.Summary }}
  {{ $summary = $item.Summary }}
{{ end }}

<div class="card-simple">

  {{ if eq $item.Type "courses" }}
  <div class="article-metadata">
    <span>
      {{ partial "functions/get_course_dates" $item }}
    </span>
    {{ with $item.Params.location }}
    <span class="middot-divider"></span>
    <span>{{ . }}</span>
    {{ end }}
  </div>
  {{ else }}
    {{ partial "page_metadata" (dict "page" $item "is_list" 1) }}
  {{ end }}

  {{ $resource := ($item.Resources.ByType "image").GetMatch "*featured*" }}
  {{ $anchor := $item.Params.image.focal_point | default "Smart" }}
  {{ with $resource }}
  {{ $image := .Fill (printf "918x517 q90 %s" $anchor) }}
  <a href="{{ $item.RelPermalink }}">
      <img src="{{ $image.RelPermalink }}" class="article-banner" alt="">
  </a>
  {{end}}

  <details>
    <summary>{{ $item.Title }}</summary>
    <div class="row">
      <div class="col-lg-6">
        <h3><i class="fas fa-graduation-cap"></i> {{ i18n "instructors" }}</h3>
        <ul class="ul-edu fa-ul">
          {{ range $index, $instructor := $item.Params.instructors }}
          <li>
            <i class="fa-li fas fa-user-alt"></i>
            <div class="description">
              <p class="instructor">{{ $instructor.name }}
              {{ if $instructor.email }}
              : <a href='mailto:{{ $instructor.email }}?subject=PIMS Course registration enquiry : {{ $item.Title }}'>{{ $instructor.email }} <i class="fa fa-envelope" aria-hidden="true"></i></a>
              {{ end }}
              <p class="institution">{{ $instructor.institution }}</p>
            </div>
          </li>
          {{ end }}
        </ul>
      </div>
      <div class="col-lg-6">
        <h3><i class="fas fa-sign-in-alt"></i> Registration</h3>
          <div class="article-style">
            {{ if $item.Params.registration_open }}
            <p>This course is available for registration under the Western
            Dean's Agreement. To register, you must obtain the approval of the
            course instructor (use the email link to the left) and you must complete the <a target="_blank"
            href="http://wcdgs.ca/content/dam/ex/wcdgs/Western-Deans-Agreement.pdf">Western
          Deans' agreement form  <i class="fas fa-file-pdf"
            aria-hidden="true"></i></a>, using the details below. The completed
        form should be signed by your home institution department and school of
        graduate studies, then returned to the host institution of the course.</p>
            <div class="row">
              <div class="col-lg-12">
                <dl class="row">
                  <dt class="col-sm-4">Course Name</dt>
                  <dd class="col-sm-8">{{ $item.Params.course_title }}</dd>
                  <dt class="col-sm-4">Course Number</dt>
                  <dd class="col-sm-8">{{ $item.Params.course_number }}</dd>
                  <dt class="col-sm-4">Section Number</dt>
                  <dd class="col-sm-8">{{ $item.Params.section_number }}</dd>
                  <dt class="col-sm-4">Section Code</dt>
                  <dd class="col-sm-8">{{ $item.Params.section_code }}</dd>
                </dl>
              </div>
            </div>
            <p>The Western Deans' Agreement provides an automatic tuition fee
            waiver for visiting students. Graduate students paying normal
            required tuition fees at their home institution will not pay
            tuition fees to the host institution. However, students may be
            required to pay other ancillary fees to the host institution, or
            explicitly request exemptions from some items (e.g. Insurance or
            travel fees).  For help with completing the Western Deanâ€™s
            agreement form, please contact the graduate student program
            coordinator at your institution. For more information about the
            agreement, please see the <a target="_blank"
            href="http://wcdgs.ca/western-deans-agreement.html">Western Dean's
            Agreement website <i class="fas fa-external-link-alt"></i></a>.</p>
            {{ else }} <p>Registration for this course is no longer
            available.</p> {{ end }}
          </div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-12">
        <h2>{{ i18n "abstract" }}</h2>
        {{ with $item.Params.abstract }}
        <div class="article-style">
          <p>{{ . | markdownify }}</p>
        </div>
        {{end}}
        {{ if $item.Params.syllabus_txt }}
          <h2>{{ i18n "syllabus" }}</h2>
          {{ with $item.Params.syllabus_txt }}
          <div class="article-style">
            <p>{{ . | markdownify }}</p>
          </div>
          {{ end }}
        {{ end }}
        <h2>{{ i18n "otherinfo" }}</h2>
        {{ with $item.Content }}
        <div class="article-style">
          <p>{{ . | markdownify }}</p>
        </div>
        {{ end }}
      </div>
    </div>

  </details>
  {{ if $show_buttons }}
  <div class="btn-links">
    {{ partial "page_links" (dict "page" $item "is_list" 1) }}
  </div>
  {{ end }}
  {{ if $item.Params.instructors }}
  <div class="article-metadata-footer">
  <div>
    {{ range $index, $instructor := $item.Params.instructors }}
    {{- if gt $index 0 }}, {{ end -}}
    <span>{{ $instructor.name }} ({{ $instructor.institution }})</span>
    {{ end }}
  </div>
  </div>
  {{ end }}

</div>
